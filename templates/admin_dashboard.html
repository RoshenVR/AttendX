{% extends "base.html" %}

{% block content %}
<div class="row align-items-center mb-5">
    <div class="col-md-6">
        <h2 class="display-6 fw-bold mb-0">Admin Dashboard</h2>
        <p class="text-muted mb-0">System Overview & Management</p>
    </div>
    <div class="col-md-6 text-md-end">
        <span class="badge bg-primary fs-6">{{ now }}</span>
    </div>
</div>

<!-- Stats Row -->
<div class="row g-4 mb-5">
    <div class="col-md-6 col-lg-3">
        <div class="card h-100 border-0 bg-dark-subtle">
            <div class="card-body d-flex align-items-center">
                <div class="icon-square bg-primary text-white rounded-3 fs-1 p-3 me-3">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <div>
                    <h3 class="fw-bold mb-0">{{ total_teachers }}</h3>
                    <p class="text-muted mb-0">Teachers</p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-lg-3">
        <div class="card h-100 border-0 bg-dark-subtle">
            <div class="card-body d-flex align-items-center">
                <div class="icon-square bg-success text-white rounded-3 fs-1 p-3 me-3">
                    <i class="fas fa-user-graduate"></i>
                </div>
                <div>
                    <h3 class="fw-bold mb-0">{{ total_students }}</h3>
                    <p class="text-muted mb-0">Students</p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-lg-3">
        <div class="card h-100 border-0 bg-dark-subtle">
            <div class="card-body d-flex align-items-center">
                <div class="icon-square bg-warning text-dark rounded-3 fs-1 p-3 me-3">
                    <i class="fas fa-clock"></i>
                </div>
                <div>
                    <h3 class="fw-bold mb-0">{{ active_sessions }}</h3>
                    <p class="text-muted mb-0">Active Sessions</p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-lg-3">
        <div class="card h-100 border-0 bg-dark-subtle">
            <div class="card-body d-flex align-items-center">
                <div class="icon-square bg-danger text-white rounded-3 fs-1 p-3 me-3">
                    <i class="fas fa-history"></i>
                </div>
                <div>
                    <h3 class="fw-bold mb-0">{{ total_sessions }}</h3>
                    <p class="text-muted mb-0">Total Sessions</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Pending Approvals -->
{% if pending_students %}
<div class="row mb-5">
    <div class="col-12">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-warning bg-opacity-10 border-0 py-3">
                <h5 class="fw-bold mb-0 text-warning-emphasis">
                    <i class="fas fa-user-clock me-2"></i>Pending Student Approvals
                </h5>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th class="ps-4">Name</th>
                                <th>Student ID</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for student in pending_students %}
                            <tr>
                                <td class="ps-4 fw-bold">{{ student.name }}</td>
                                <td>{{ student.sid }}</td>
                                <td>
                                    <div class="d-flex gap-2">
                                        <a href="{{ url_for('approve_user', sid=student.sid) }}"
                                            class="btn btn-sm btn-success">
                                            <i class="fas fa-check me-1"></i>Approve
                                        </a>
                                        <a href="{{ url_for('reject_user', sid=student.sid) }}"
                                            class="btn btn-sm btn-danger">
                                            <i class="fas fa-times me-1"></i>Reject
                                        </a>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Quick Actions -->
<div class="row g-4">
    <div class="col-md-6">
        <div class="card h-100 border-0 shadow-sm">
            <div class="card-header bg-transparent border-0 pb-0">
                <h5 class="fw-bold"><i class="fas fa-plus-circle me-2 text-primary"></i>Add New Teacher</h5>
            </div>
            <div class="card-body">
                <form action="{{ url_for('add_teacher') }}" method="POST">
                    <div class="mb-3">
                        <label class="form-label">Full Name</label>
                        <input type="text" name="name" class="form-control bg-dark text-light border-secondary"
                            placeholder="Prof. John Doe" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Teacher ID</label>
                        <input type="text" name="sid" class="form-control bg-dark text-light border-secondary"
                            placeholder="T-1001" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Password</label>
                        <input type="password" name="password" class="form-control bg-dark text-light border-secondary"
                            placeholder="********" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-save me-2"></i>Create Account
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card h-100 border-0 shadow-sm">
            <div class="card-header bg-transparent border-0 pb-0">
                <h5 class="fw-bold"><i class="fas fa-cogs me-2 text-primary"></i>Quick Management</h5>
            </div>
            <div class="card-body d-flex flex-column gap-3">
                <a href="{{ url_for('admin_users') }}"
                    class="btn btn-dark d-flex justify-content-between align-items-center p-3 border border-secondary">
                    <span class="text-start">
                        <div class="fw-bold">Manage Users</div>
                        <small class="text-muted">View, edit, or delete users</small>
                    </span>
                    <i class="fas fa-chevron-right text-muted"></i>
                </a>

                <a href="{{ url_for('admin_reports') }}"
                    class="btn btn-dark d-flex justify-content-between align-items-center p-3 border border-secondary">
                    <span class="text-start">
                        <div class="fw-bold">System Reports</div>
                        <small class="text-muted">View all attendance records</small>
                    </span>
                    <i class="fas fa-chevron-right text-muted"></i>
                </a>

                <a href="{{ url_for('admin_subjects') }}"
                    class="btn btn-dark d-flex justify-content-between align-items-center p-3 border border-secondary">
                    <span class="text-start">
                        <div class="fw-bold">Manage Subjects</div>
                        <small class="text-muted">Add, edit, or delete subjects</small>
                    </span>
                    <i class="fas fa-chevron-right text-muted"></i>
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}